<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>CodingPrime</title>
    <link rel="alternate" type="application/atom+xml" href="index.xml">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Inconsolata%7COswald%7COxygen%7CSource+Code+Pro">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="stylesheet" href="/assets/css/highlight.js.solarized.css">
  </head>
  <body>
    <header>
      <div class="container">
        <h1><a href="/">CodingPrime</a></h1><span>&lt;strong&gt;kung fu&lt;/strong&gt;</span><a href="https://github.com/t3hpr1m3/codingprime.com"><img style="position: absolute; top: 0; right: 0; border: 0" src="https://camo.githubusercontent.com/652c5b9acfaddf3a9c326fa6bde407b87f7be0f4/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6f72616e67655f6666373630302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png"></a>
      </div>
    </header>
    <main class="container">
      <article class="post">
        <header>
          <time datetime="2013-08-31T11:46:00.000Z">August 31, 2013</time>
          <h2><a href="/blog/2013/08/modelme-why">ModelMe...why?</a></h2>
        </header>
        <section>
          <p><p>My day job consists of architecting and maintaining several Rails
applications.  Some of these must deal with custom data sources that
were architected before there were standards for inter-application
communication (SOAP, REST, XML-RPC, etc).  One in particular is is a custom TCP
server that responds to method calls (using XML as the transport mechanism).
Replacing the service is not an option (as is usually the case with any
<a href="http://fc05.deviantart.net/fs71/f/2012/013/0/7/pain_in_the_ass_by_sk8rnerd-d4m9ag5.jpg">PITA</a>
legacy problem), so I have to communicate with it.</p></p>
        </section>
        <footer>
          <nav><a class="btn" href="/blog/2013/08/modelme-why">Read More/Comment<i class="fa fa-arrow-right"></i></a></nav>
        </footer>
      </article>
      <article class="post">
        <header>
          <time datetime="2012-07-12T17:20:00.000Z">July 12, 2012</time>
          <h2><a href="/blog/2012/07/skipping-asset-precompile">Skipping asset precompile</a></h2>
        </header>
        <section>
          <p><p>Waiting on asset precompilation is a PITA, especially if no assets have been
changed.  Thankfully,
<a href="http://www.bencurtis.com/2011/12/skipping-asset-compilation-with-capistrano/">Ben Curtis</a>
came up with a workable solution.  Except...</p>
<p>Ben's method fails on the initial deployment, because <em>current_revision</em> tries to
read <em>/path/to/app/current/REVISION</em>, which won't exist yet.  After trying several
approaches, I have arrived at one which works for me.  There are probably other,
more elegant approaches, but this one seems clear enough for my purposes.
Posting it here for posterity.</p></p>
        </section>
        <footer>
          <nav><a class="btn" href="/blog/2012/07/skipping-asset-precompile">Read More/Comment<i class="fa fa-arrow-right"></i></a></nav>
        </footer>
      </article>
      <article class="post">
        <header>
          <time datetime="2010-12-06T18:19:00.000Z">December 6, 2010</time>
          <h2><a href="/blog/2010/12/rspec-autotest-rails3-and-engines">RSpec, Autotest, Rails3, and Engines</a></h2>
        </header>
        <section>
          <p><p>I've got an app I'm building that is comprised of several engines running in
<em>vendor/nsweb</em>.  I want each engine to have its own specs, without cluttering
up the main app's <em>spec</em> folder.  I also want to be able to run tests for ALL
engines at once, both using rake and through autotest.  To accomplish the first
task, I added the following:</p>
<pre><code class="hljs ruby"><span class="hljs-comment"># lib/tasks/rspec.rake</span>
RSpec::Core::RakeTask.module_eval <span class="hljs-keyword">do</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">pattern</span></span>
    extras = []
    Dir[File.join( File.expand_path( <span class="hljs-string">'vendor'</span> ), <span class="hljs-string">'nsweb'</span>, <span class="hljs-string">'*'</span> )].flatten.each <span class="hljs-keyword">do</span> <span class="hljs-params">|dir|</span>
      <span class="hljs-keyword">if</span> File.directory?( dir )
        extras += File.join( dir, <span class="hljs-string">'spec'</span>, <span class="hljs-string">'**'</span>, <span class="hljs-string">'*_spec.rb'</span> ).to_s
      <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">end</span>
    [@pattern] <span class="hljs-params">| extras
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</span></code></pre></p>
        </section>
        <footer>
          <nav><a class="btn" href="/blog/2010/12/rspec-autotest-rails3-and-engines">Read More/Comment<i class="fa fa-arrow-right"></i></a></nav>
        </footer>
      </article>
      <article class="post">
        <header>
          <time datetime="2010-09-02T08:38:00.000Z">September 2, 2010</time>
          <h2><a href="/blog/2010/09/form-cancel-button-without-javascript">Form cancel button (without Javascript)</a></h2>
        </header>
        <section>
          <p><p>Found <a href="http://rubypond.com/blog/capturing-a-form-cancel">this</a> today, and
banged my head on the desk for never thinking of this when trying to add a
cancel button to a form, regardless of the language.</p>
</p>
        </section>
        <footer>
          <nav><a class="btn" href="/blog/2010/09/form-cancel-button-without-javascript">Read More/Comment<i class="fa fa-arrow-right"></i></a></nav>
        </footer>
      </article>
      <article class="post">
        <header>
          <time datetime="2010-08-22T19:00:00.000Z">August 22, 2010</time>
          <h2><a href="/blog/2010/08/custom-rspec-matcher-require-authentication-for">Custom RSpec matcher:  require_authentication_for</a></h2>
        </header>
        <section>
          <p><p>Like everyone, I have a bunch of controller actions that need to be protected
from unauthorized users.  I've got RSpec tests around these methods that look
like this:</p>
<pre><code class="hljs ruby">describe UsersController, <span class="hljs-string">'as guest'</span> <span class="hljs-keyword">do</span>
  before( <span class="hljs-symbol">:each</span> ) <span class="hljs-keyword">do</span>
    controller.stubs( <span class="hljs-symbol">:current_user</span> ).returns( <span class="hljs-literal">nil</span> )
  <span class="hljs-keyword">end</span>

  describe <span class="hljs-string">'index'</span> <span class="hljs-keyword">do</span>
    it <span class="hljs-string">'should prevent access'</span> <span class="hljs-keyword">do</span>
      lambda { get <span class="hljs-symbol">:index</span> }.should
        raise_error( Exceptions::PermissionDenied )
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>

  describe <span class="hljs-string">'edit'</span> <span class="hljs-keyword">do</span>
    it <span class="hljs-string">'should prevent access'</span> <span class="hljs-keyword">do</span>
      lambda { get <span class="hljs-symbol">:edit</span>, <span class="hljs-symbol">:id</span> =&gt; <span class="hljs-number">1</span> }.should
        raise_error( Exceptions::PermissionDenied )
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>

  describe <span class="hljs-string">'create'</span> <span class="hljs-keyword">do</span>
    it <span class="hljs-string">'should prevent access'</span> <span class="hljs-keyword">do</span>
      lambda { post <span class="hljs-symbol">:create</span>, <span class="hljs-symbol">:id</span> =&gt; <span class="hljs-number">1</span> }.should
        raise_error( Exceptions::PermissionDenied )
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre></p>
        </section>
        <footer>
          <nav><a class="btn" href="/blog/2010/08/custom-rspec-matcher-require-authentication-for">Read More/Comment<i class="fa fa-arrow-right"></i></a></nav>
        </footer>
      </article>
      <nav class="pagination"><a class="btn pull-right" href="/blog/page/4">Older<i class="fa fa-chevron-circle-right"></i></a><a class="btn pull-left" href="/blog/page/2"><i class="fa fa-chevron-circle-left"></i>Newer</a>
      </nav>
    </main>
    <footer class="site-footer">
      <div class="container clearfix">
        <p class="text"><span>&copy;2016 Josh Williams</span><a href="https://github.com/t3hpr1m3"><i class="fa fa-github fa-3x"></i></a><a href="https://twitter.com/t3hpr1m3"><i class="fa fa-twitter fa-3x"></i></a></p>
      </div>
    </footer>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      
      ga('create', 'UA-18124207-1', 'auto');
      ga('send', 'pageview');
    </script>
  </body>
</html>